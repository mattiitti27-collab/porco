<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INTINI SYSTEM | Deep Analytics</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        bg: '#040406',
                        panel: '#0E0E12',
                        border: '#1F1F26',
                        primary: '#3B82F6', // Tech Blue
                        accent: '#06B6D4',  // Cyan
                        success: '#10B981', // Green data
                        gold: '#F59E0B',    // Gold data
                        danger: '#EF4444',  // Alert
                        textMain: '#F3F4F6',
                        textDim: '#6B7280'
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['"Space Mono"', 'monospace']
                    },
                    backgroundImage: {
                        'grid-pattern': "linear-gradient(to right, #1f1f26 1px, transparent 1px), linear-gradient(to bottom, #1f1f26 1px, transparent 1px)"
                    }
                }
            }
        }
    </script>

    <style>
        body { 
            background-color: #040406;
            color: #E5E5E5; 
            overflow: hidden;
        }

        /* --- BACKGROUND TECH GRID --- */
        .tech-bg {
            position: absolute; inset: 0; z-index: -1;
            background-size: 40px 40px;
            background-image: 
                linear-gradient(to right, rgba(255,255,255,0.03) 1px, transparent 1px),
                linear-gradient(to bottom, rgba(255,255,255,0.03) 1px, transparent 1px);
            mask-image: radial-gradient(circle at 50% 50%, black 40%, transparent 100%);
        }

        /* --- GLASS PANELS PRO --- */
        .deep-card {
            background: rgba(14, 14, 18, 0.7);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            box-shadow: 0 4px 24px rgba(0,0,0,0.4);
            transition: all 0.3s ease;
        }
        .deep-card:hover {
            border-color: rgba(6, 182, 212, 0.3); /* Cyan Glow border on hover */
            box-shadow: 0 8px 32px rgba(6, 182, 212, 0.1);
        }

        /* --- TYPOGRAPHY --- */
        .label-tech {
            font-family: 'Space Mono', monospace;
            font-size: 9px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #6B7280;
        }

        /* --- INPUTS --- */
        .deep-input {
            background: rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 6px;
            color: white;
            font-family: 'Space Mono', monospace;
            transition: all 0.2s;
        }
        .deep-input:focus {
            outline: none;
            border-color: #3B82F6;
            background: rgba(59, 130, 246, 0.05);
        }

        /* --- CUSTOM UI ELEMENTS --- */
        /* Checkbox */
        .tech-check input:checked + div {
            background: #06B6D4;
            border-color: #06B6D4;
            box-shadow: 0 0 12px rgba(6, 182, 212, 0.4);
        }
        
        /* Range Slider */
        input[type=range] { -webkit-appearance: none; background: transparent; }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none; height: 16px; width: 6px; 
            background: #10B981; border-radius: 2px;
            cursor: pointer; margin-top: -6px; box-shadow: 0 0 10px rgba(16, 185, 129, 0.5);
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%; height: 4px; background: #1F1F26; border-radius: 2px;
        }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 4px; }
    </style>
</head>
<body class="h-screen flex flex-col p-4 md:p-6 gap-6">

    <div class="tech-bg"></div>

    <header class="flex justify-between items-center pb-4 border-b border-white/5">
        <div class="flex items-center gap-4">
            <div class="w-10 h-10 rounded-lg bg-gradient-to-br from-primary to-accent flex items-center justify-center shadow-[0_0_15px_rgba(6,182,212,0.3)]">
                <i class="fa-solid fa-layer-group text-black text-xl"></i>
            </div>
            <div>
                <h1 class="text-2xl font-bold tracking-tight text-white leading-none">
                    INTINI<span class="font-light text-gray-400">SYSTEM</span>
                </h1>
                <div class="flex items-center gap-2 mt-1">
                    <span class="w-2 h-2 rounded-full bg-success animate-pulse"></span>
                    <p class="text-[10px] font-mono text-accent uppercase tracking-widest">Deep Analytics v1.0</p>
                </div>
            </div>
        </div>

        <div class="flex items-center gap-1 bg-panel border border-white/10 rounded-lg p-1">
            <button onclick="changeMonth(-1)" class="w-8 h-8 flex items-center justify-center text-textDim hover:text-white transition"><i class="fa-solid fa-chevron-left text-xs"></i></button>
            <div id="month-display" class="w-32 text-center font-mono font-bold text-sm text-white uppercase"></div>
            <button onclick="changeMonth(1)" class="w-8 h-8 flex items-center justify-center text-textDim hover:text-white transition"><i class="fa-solid fa-chevron-right text-xs"></i></button>
            <div class="w-px h-4 bg-white/10 mx-2"></div>
            <button onclick="setToday()" class="px-3 h-8 text-[10px] font-bold text-primary hover:bg-white/5 rounded transition uppercase">Today</button>
        </div>
    </header>

    <main class="flex-1 grid grid-cols-1 lg:grid-cols-12 gap-6 overflow-hidden">

        <aside class="lg:col-span-3 flex flex-col gap-4 overflow-y-auto pr-1">
            
            <div class="deep-card p-4">
                <div class="label-tech mb-2">Target Date</div>
                <div class="flex justify-between items-center bg-black/40 border border-white/5 rounded-lg p-2">
                    <button onclick="changeDay(-1)" class="w-8 h-8 rounded hover:bg-white/5 text-textDim hover:text-white transition"><i class="fa-solid fa-arrow-left"></i></button>
                    <div class="text-center">
                        <div id="day-name" class="text-[9px] text-accent font-bold uppercase tracking-widest"></div>
                        <div id="day-num" class="text-2xl font-mono font-bold text-white"></div>
                    </div>
                    <button onclick="changeDay(1)" class="w-8 h-8 rounded hover:bg-white/5 text-textDim hover:text-white transition"><i class="fa-solid fa-arrow-right"></i></button>
                </div>
            </div>

            <div class="deep-card p-5 flex-1 flex flex-col gap-6">
                <div class="flex items-center justify-between border-b border-white/5 pb-2">
                    <span class="label-tech text-white"><i class="fa-solid fa-terminal mr-2 text-primary"></i>Data Entry</span>
                    <span class="w-2 h-2 rounded-full bg-primary/50"></span>
                </div>

                <div>
                    <div class="flex justify-between items-center mb-2">
                        <span class="label-tech">Protocol</span>
                        <button onclick="toggleEdit()" class="text-[9px] text-primary hover:text-white transition"><i class="fa-solid fa-gear"></i></button>
                    </div>
                    
                    <div id="habit-editor" class="hidden mb-3 p-2 bg-black/40 border border-white/5 rounded">
                        <div class="flex gap-2 mb-2">
                            <input id="new-habit" class="deep-input w-full p-1.5 text-xs" placeholder="Add task...">
                            <button onclick="addHabit()" class="text-success font-bold px-2 hover:bg-white/5 rounded">+</button>
                        </div>
                        <div id="editor-list" class="max-h-24 overflow-y-auto space-y-1"></div>
                    </div>

                    <div id="habit-list" class="space-y-2"></div>
                </div>

                <div class="space-y-4">
                    <div class="grid grid-cols-2 gap-3">
                        <div>
                            <span class="label-tech block mb-1">Income (‚Ç¨)</span>
                            <input type="number" id="input-money" class="deep-input w-full p-2 text-gold font-bold text-right" placeholder="0" oninput="saveData()">
                        </div>
                        <div>
                            <span class="label-tech block mb-1">Sleep (h)</span>
                            <input type="number" id="input-sleep" class="deep-input w-full p-2 text-primary font-bold text-right" placeholder="0" oninput="saveData()">
                        </div>
                    </div>
                    
                    <div>
                        <div class="flex justify-between mb-1">
                            <span class="label-tech">Push Intensity</span>
                            <span id="push-val" class="text-xs font-mono text-white">0.0</span>
                        </div>
                        <input type="range" id="input-push" min="0" max="10" step="1" class="w-full" oninput="updatePushVal(); saveData()">
                    </div>

                    <div>
                        <span class="label-tech block mb-2">Mental State</span>
                        <div class="grid grid-cols-5 gap-1">
                            <button onclick="setMood(1)" id="m1" class="h-8 rounded bg-white/5 border border-transparent hover:border-danger text-xs grayscale hover:grayscale-0 transition opacity-50 hover:opacity-100">üõë</button>
                            <button onclick="setMood(2)" id="m2" class="h-8 rounded bg-white/5 border border-transparent hover:border-orange-500 text-xs grayscale hover:grayscale-0 transition opacity-50 hover:opacity-100">‚ö†Ô∏è</button>
                            <button onclick="setMood(3)" id="m3" class="h-8 rounded bg-white/5 border border-transparent hover:border-yellow-500 text-xs grayscale hover:grayscale-0 transition opacity-50 hover:opacity-100">‚ö°</button>
                            <button onclick="setMood(4)" id="m4" class="h-8 rounded bg-white/5 border border-transparent hover:border-blue-500 text-xs grayscale hover:grayscale-0 transition opacity-50 hover:opacity-100">üåÄ</button>
                            <button onclick="setMood(5)" id="m5" class="h-8 rounded bg-white/5 border border-transparent hover:border-success text-xs grayscale hover:grayscale-0 transition opacity-50 hover:opacity-100">üöÄ</button>
                        </div>
                        <input type="hidden" id="input-mood">
                    </div>
                </div>
            </div>

            <div class="deep-card p-3">
                <textarea id="input-notes" class="w-full bg-transparent text-xs font-mono text-gray-400 border-none focus:outline-none resize-none h-12 placeholder-gray-700" placeholder="> System Log..." oninput="saveData()"></textarea>
            </div>
        </aside>

        <section class="lg:col-span-9 flex flex-col gap-6 overflow-y-auto pr-1">
            
            <div class="grid grid-cols-4 gap-4">
                <div class="deep-card p-5 group cursor-default">
                    <div class="flex justify-between items-start mb-2">
                        <span class="label-tech text-primary">Consistency</span>
                        <i class="fa-solid fa-chart-simple text-primary/50 group-hover:text-primary transition"></i>
                    </div>
                    <div id="kpi-cons" class="text-3xl font-mono font-bold text-white group-hover:scale-105 transition-transform origin-left">0%</div>
                </div>
                <div class="deep-card p-5 group cursor-default">
                    <div class="flex justify-between items-start mb-2">
                        <span class="label-tech text-gold">Net Income</span>
                        <i class="fa-solid fa-coins text-gold/50 group-hover:text-gold transition"></i>
                    </div>
                    <div id="kpi-inc" class="text-3xl font-mono font-bold text-white group-hover:scale-105 transition-transform origin-left">0</div>
                </div>
                <div class="deep-card p-5 group cursor-default">
                    <div class="flex justify-between items-start mb-2">
                        <span class="label-tech text-success">Push Avg</span>
                        <i class="fa-solid fa-bolt text-success/50 group-hover:text-success transition"></i>
                    </div>
                    <div id="kpi-push" class="text-3xl font-mono font-bold text-white group-hover:scale-105 transition-transform origin-left">0.0</div>
                </div>
                <div class="deep-card p-5 group cursor-default">
                    <div class="flex justify-between items-start mb-2">
                        <span class="label-tech text-white">Streak</span>
                        <i class="fa-solid fa-link text-white/50 group-hover:text-white transition"></i>
                    </div>
                    <div id="kpi-streak" class="text-3xl font-mono font-bold text-white group-hover:scale-105 transition-transform origin-left">0</div>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 flex-1 min-h-[500px]">
                
                <div class="deep-card p-5 flex flex-col">
                    <div class="flex justify-between items-center mb-4">
                        <div class="label-tech text-white"><span class="w-1.5 h-1.5 rounded-full bg-accent inline-block mr-2"></span>Protocol Adherence</div>
                    </div>
                    <div class="flex-1 w-full relative min-h-[180px]">
                        <canvas id="chartCons"></canvas>
                    </div>
                </div>

                <div class="deep-card p-5 flex flex-col">
                    <div class="flex justify-between items-center mb-4">
                        <div class="label-tech text-white"><span class="w-1.5 h-1.5 rounded-full bg-gold inline-block mr-2"></span>Income Stream</div>
                    </div>
                    <div class="flex-1 w-full relative min-h-[180px]">
                        <canvas id="chartMoney"></canvas>
                    </div>
                </div>

                <div class="deep-card p-5 flex flex-col">
                    <div class="flex justify-between items-center mb-4">
                        <div class="label-tech text-white"><span class="w-1.5 h-1.5 rounded-full bg-primary inline-block mr-2"></span>Sleep Cycles</div>
                    </div>
                    <div class="flex-1 w-full relative min-h-[180px]">
                        <canvas id="chartSleep"></canvas>
                    </div>
                </div>

                <div class="deep-card p-5 flex flex-col">
                    <div class="flex justify-between items-center mb-4">
                        <div class="label-tech text-white"><span class="w-1.5 h-1.5 rounded-full bg-success inline-block mr-2"></span>Bio-Metrics (Push/Mood)</div>
                    </div>
                    <div class="flex-1 w-full relative min-h-[180px]">
                        <canvas id="chartPush"></canvas>
                    </div>
                </div>

            </div>

        </section>
    </main>

    <script>
        // --- LOGIC CORE ---
        const DEFAULT_HABITS = ["Wake Up 07:00", "Deep Work 4h", "Training", "Clean Diet", "Reading"];
        let state = {
            date: new Date(),
            habits: JSON.parse(localStorage.getItem('intiniHabits')) || DEFAULT_HABITS,
            data: JSON.parse(localStorage.getItem('intiniData')) || {},
            charts: {}
        };
        const getKey = (d) => d.toISOString().split('T')[0];

        function init() { updateDateUI(); loadData(); }

        function loadData() {
            const key = getKey(state.date);
            const d = state.data[key] || { checked: [], sleep: '', money: '', notes: '', push: 0, mood: 3 };

            document.getElementById('input-money').value = d.money;
            document.getElementById('input-sleep').value = d.sleep;
            document.getElementById('input-notes').value = d.notes;
            document.getElementById('input-push').value = d.push || 0;
            document.getElementById('push-val').innerText = d.push || 0;
            const mood = d.mood || 3;
            document.getElementById('input-mood').value = mood;
            highlightMood(mood);

            renderHabits(d.checked);
            updateCharts();
            updateKPIs();
        }

        function saveData() {
            const key = getKey(state.date);
            const checked = [];
            state.habits.forEach((h, i) => { if(document.getElementById(`h-${i}`)?.checked) checked.push(h); });

            state.data[key] = {
                checked,
                money: document.getElementById('input-money').value,
                sleep: document.getElementById('input-sleep').value,
                notes: document.getElementById('input-notes').value,
                push: document.getElementById('input-push').value,
                mood: document.getElementById('input-mood').value
            };
            localStorage.setItem('intiniData', JSON.stringify(state.data));
            updateCharts();
            updateKPIs();
        }

        function renderHabits(checked) {
            const list = document.getElementById('habit-list');
            const editor = document.getElementById('editor-list');
            list.innerHTML = ''; editor.innerHTML = '';

            state.habits.forEach((h, i) => {
                const isC = checked.includes(h);
                list.innerHTML += `
                    <label class="tech-check flex items-center gap-3 cursor-pointer group p-2 rounded-lg hover:bg-white/5 transition border border-transparent hover:border-white/5">
                        <div class="relative w-4 h-4 flex-shrink-0">
                            <input type="checkbox" id="h-${i}" class="sr-only" onchange="saveData()" ${isC ? 'checked' : ''}>
                            <div class="w-4 h-4 border border-white/20 rounded-[4px] bg-black transition-all"></div>
                        </div>
                        <span class="text-[10px] font-mono text-gray-400 group-hover:text-accent uppercase tracking-wide transition-colors ${isC ? 'text-white' : ''}">${h}</span>
                    </label>
                `;
                editor.innerHTML += `<div class="flex justify-between text-[10px] text-gray-400 border-b border-white/5 py-1 font-mono"><span>${h}</span><button onclick="remHabit(${i})" class="text-danger hover:text-white">X</button></div>`;
            });
        }
        function toggleEdit() { document.getElementById('habit-editor').classList.toggle('hidden'); }
        function addHabit() { const v = document.getElementById('new-habit').value.trim(); if(v){ state.habits.push(v); localStorage.setItem('intiniHabits', JSON.stringify(state.habits)); loadData(); document.getElementById('new-habit').value=''; }}
        function remHabit(i) { state.habits.splice(i,1); localStorage.setItem('intiniHabits', JSON.stringify(state.habits)); loadData(); }

        function updateDateUI() {
            const d = state.date;
            document.getElementById('month-display').innerText = d.toLocaleDateString('en-US', { month: 'long', year: 'numeric' });
            document.getElementById('day-name').innerText = d.toLocaleDateString('en-US', { weekday: 'long' });
            document.getElementById('day-num').innerText = d.getDate();
        }
        function changeDay(n) { state.date.setDate(state.date.getDate()+n); updateDateUI(); loadData(); }
        function changeMonth(n) { state.date.setMonth(state.date.getMonth()+n); state.date.setDate(1); updateDateUI(); loadData(); }
        function setToday() { state.date = new Date(); updateDateUI(); loadData(); }
        function updatePushVal() { document.getElementById('push-val').innerText = document.getElementById('input-push').value; }
        function setMood(v) { document.getElementById('input-mood').value = v; highlightMood(v); saveData(); }
        function highlightMood(v) { document.querySelectorAll('#input-mood ~ div button').forEach(b => { b.classList.remove('opacity-100', 'bg-white/10', 'grayscale-0', 'border-white/20'); b.classList.add('opacity-50', 'grayscale', 'border-transparent'); }); const el=document.getElementById(`m${v}`); if(el){ el.classList.remove('opacity-50', 'grayscale', 'border-transparent'); el.classList.add('opacity-100', 'bg-white/10', 'grayscale-0', 'border-white/20'); } }

        function updateKPIs() {
            const y = state.date.getFullYear(), m = state.date.getMonth();
            const days = new Date(y, m+1, 0).getDate();
            let totCons=0, totInc=0, totPush=0, count=0;
            const totalH = state.habits.length || 1;

            for(let i=1; i<=days; i++) {
                const d = state.data[getKey(new Date(y, m, i, 12))];
                if(d) { count++; totCons += (d.checked?.length||0); totInc += parseFloat(d.money)||0; totPush += parseFloat(d.push)||0; }
            }
            document.getElementById('kpi-cons').innerText = count ? Math.round((totCons/(count*totalH))*100)+'%' : '0%';
            document.getElementById('kpi-inc').innerText = totInc.toLocaleString('en-US');
            document.getElementById('kpi-push').innerText = count ? (totPush/count).toFixed(1) : '0.0';
            
            let s=0, cd=new Date();
            while(true) {
                const d = state.data[getKey(cd)];
                if(d && d.checked?.length >= totalH/2) { s++; cd.setDate(cd.getDate()-1); } else break;
            }
            document.getElementById('kpi-streak').innerText = s;
        }

        function updateCharts() {
            const y = state.date.getFullYear(), m = state.date.getMonth();
            const days = new Date(y, m+1, 0).getDate();
            const labels=[], cData=[], mData=[], sData=[], pData=[], moodData=[];
            const totalH = state.habits.length || 1;

            for(let i=1; i<=days; i++) {
                labels.push(i);
                const d = state.data[getKey(new Date(y, m, i, 12))];
                if(d) {
                    cData.push(Math.round(((d.checked?.length||0)/totalH)*100));
                    mData.push(parseFloat(d.money)||0);
                    sData.push(parseFloat(d.sleep)||0);
                    pData.push(parseFloat(d.push)||0);
                    moodData.push(parseFloat(d.mood)||0);
                } else { cData.push(0); mData.push(0); sData.push(0); pData.push(0); moodData.push(0); }
            }

            renderChart('chartCons', labels, cData, '#06B6D4', 'line', true);
            renderChart('chartMoney', labels, mData, '#F59E0B', 'bar', false);
            renderChart('chartSleep', labels, sData, '#3B82F6', 'line', true);
            renderChart('chartPush', labels, pData, '#10B981', 'line', false, moodData);
        }

        function renderChart(id, labels, data, color, type, fill, data2=null) {
            const ctx = document.getElementById(id).getContext('2d');
            if(state.charts[id]) state.charts[id].destroy();

            // Create Deep Gradient
            let bg = color;
            if(fill && type === 'line') {
                const gradient = ctx.createLinearGradient(0, 0, 0, 400);
                gradient.addColorStop(0, hexToRgbA(color, 0.5));
                gradient.addColorStop(1, hexToRgbA(color, 0));
                bg = gradient;
            }

            const datasets = [{
                label: 'Value', data: data,
                borderColor: color, backgroundColor: bg,
                borderWidth: 2, pointRadius: 0, hoverRadius: 6, fill: fill, tension: 0.4
            }];

            if(data2) {
                datasets.push({
                    label: 'Mood', data: data2,
                    borderColor: '#EF4444', borderDash: [3,3], borderWidth: 1, pointRadius:0, tension:0.4, yAxisID: 'y1'
                });
            }

            state.charts[id] = new Chart(ctx, {
                type: type,
                data: { labels, datasets },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: { legend: {display: false}, tooltip: {backgroundColor: '#0E0E12', borderColor: '#333', borderWidth: 1, titleFont: {family: 'Space Mono'}, bodyFont: {family: 'Space Mono'}} },
                    scales: {
                        x: { grid: {color: 'rgba(255,255,255,0.02)'}, ticks: {color: '#4B5563', font:{size:9, family:'Space Mono'}} },
                        y: { beginAtZero: true, grid: {color: 'rgba(255,255,255,0.02)'}, ticks: {color: '#4B5563', font:{size:9, family:'Space Mono'}} },
                        y1: { display: !!data2, position: 'right', grid:{display:false} }
                    }
                }
            });
        }
        
        function hexToRgbA(hex, alpha){
            let c;
            if(/^#([A-Fa-f0-9]{3}){1,2}$/.test(hex)){
                c= hex.substring(1).split('');
                if(c.length== 3){ c= [c[0], c[0], c[1], c[1], c[2], c[2]]; }
                c= '0x'+c.join('');
                return 'rgba('+[(c>>16)&255, (c>>8)&255, c&255].join(',')+','+alpha+')';
            }
            return hex;
        }

        init();
    </script>
</body>
</html>
